(()=>{var e={};e.id=1931,e.ids=[1931],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},96658:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>d,originalPathname:()=>p,pages:()=>u,routeModule:()=>g,tree:()=>c});var a=r(67096),s=r(16132),o=r(37284),l=r.n(o),n=r(32564),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);r.d(t,i);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,29447)),"/Users/delta/DMTS/src/app/page.js"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,75378)),"/Users/delta/DMTS/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/delta/DMTS/src/app/page.js"],p="/page",d={require:r,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},94067:(e,t,r)=>{Promise.resolve().then(r.bind(r,95335))},95335:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var a=r(30784),s=r(9885),o=r(69335),l=r(54997),n=r(18787),i=r(78653),c=r(92210);let __WEBPACK_DEFAULT_EXPORT__=()=>{let[e,t]=(0,s.useState)(null),[r,u]=(0,s.useState)([]),[p,d]=(0,s.useState)(""),[g,m]=(0,s.useState)(1),[h,x]=(0,s.useState)(null),[_,f]=(0,s.useState)([]),[j,P]=(0,s.useState)({name:"All Project",_id:""}),[v,M]=(0,s.useState)([]),[y,S]=(0,s.useState)(0),[q,A]=(0,s.useState)(0),[E,b]=(0,s.useState)(!1),[w,C]=(0,s.useState)(!0);(0,s.useEffect)(()=>{E&&b(!1)},[E]),(0,s.useEffect)(()=>{C(!1),C(!0),console.log("cooords",v)},[y]);let handleProjectChange=e=>{let t=N.find(t=>t.ProjectName===e);P({name:e,_id:t?t._id:""})};(0,s.useEffect)(()=>{let fetchData=async()=>{await getSitesAndProject()};fetchData()},[j]),(0,s.useEffect)(()=>{M(r.map(e=>({lat:e.latitude,lng:e.longitude,projectID:e.projectID,pumpName:e.pumpName})))},[r]),(0,s.useEffect)(()=>{calculateCentroid(),calculateZoomLevel()},[v,r]);let getSitesByProjectId=async()=>{try{let e={projectID:j._id},t=await l.Z.post("api/sites/getSitesByProjectId",e);u(t.data.sites)}catch(e){console.error("Error fetching data:",e)}},getSitesAndProject=async()=>{try{m(e=>e+1),await Promise.all([getProjects(),getSitesByProjectId()])}catch(e){console.error("Error fetching data:",e)}},getProjects=async()=>{let e=await l.Z.get("/api/project/getAllProjects");f(e.data.projects)},{isLoaded:L}=(0,o.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyC_mmyHAnkTF9dUjcTngzxG9eHfS3oMbfM"}),handleMarkerHover=e=>{x(e)},handleMarkerLeave=()=>{x(null)},calculateCentroid=()=>{let e=0,t=0,r=v.length;for(let a=0;a<r;a++)e+=parseFloat(v[a].lat),t+=parseFloat(v[a].lng);let a={lat:e/r,lng:t/r};console.log("xxx old",a),S(a)},calculateZoomLevel=()=>{if(0===v.length)return 0;if(1===v.length)return 10;let e=Number.MAX_VALUE,t=Number.MIN_VALUE,r=Number.MAX_VALUE,a=Number.MIN_VALUE;for(let s=0;s<v.length;s++){let o=v[s];e=Math.min(e,parseFloat(o.lat)),t=Math.max(t,parseFloat(o.lat)),r=Math.min(r,parseFloat(o.lng)),a=Math.max(a,parseFloat(o.lng))}let s=t-e,o=a-r;A(Math.floor(Math.min(Math.log2(896/o),Math.log2(896/s))))},N=[{ProjectName:"All Project",_id:""},..._.filter(e=>e.ProjectName.toLowerCase().includes(p.toLowerCase()))];return(0,s.useEffect)(()=>{calculateCentroid(),calculateZoomLevel()},[v]),(0,a.jsxs)("div",{children:[L&&a.jsx(n.xu,{children:(0,a.jsxs)(o.b6,{mapContainerStyle:{width:"100%",height:"100vh"},center:y,zoom:q,onLoad:e=>{t(e)},onUnmount:()=>{t(null)},children:[a.jsx(n.xu,{display:"flex",gap:"4px",position:"absolute",right:"14",top:"2",children:a.jsx(i.P,{variant:"filled",width:300,value:j.name,onChange:e=>handleProjectChange(e.target.value),children:N.map(e=>a.jsx("option",{value:e.ProjectName,children:e.ProjectName},e._id))})}),v.length>0&&v.map((e,t)=>a.jsx(o.Jx,{position:{lat:parseFloat(e.lat),lng:parseFloat(e.lng)},onMouseOver:()=>handleMarkerHover(t),onMouseOut:handleMarkerLeave,children:h===t&&a.jsx(o.nx,{position:{lat:parseFloat(e.lat),lng:parseFloat(e.lng)},onCloseClick:handleMarkerLeave,children:a.jsx("div",{children:e.pumpName})})},t))]})}),!L&&a.jsx(c.Z,{})]})}},29447:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>l,__esModule:()=>o,default:()=>i});var a=r(95153);let s=(0,a.createProxy)(String.raw`/Users/delta/DMTS/src/app/page.js`),{__esModule:o,$$typeof:l}=s,n=s.default,i=n}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[6126,9760,1323,1915,9335,2189,7109],()=>__webpack_exec__(96658));module.exports=r})();