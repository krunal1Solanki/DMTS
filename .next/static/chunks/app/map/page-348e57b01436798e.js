(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{70842:function(e,t,a){Promise.resolve().then(a.bind(a,66562))},14948:function(e,t,a){"use strict";var n=a(57437);a(2265);var r=a(53808);t.Z=()=>(0,n.jsx)("div",{className:"loader",style:{textAlign:"center",backgroundColor:"white",display:"flex",justifyContent:"center",width:"100%",height:"50vh"},children:(0,n.jsx)("div",{style:{margin:"auto 0"},children:(0,n.jsx)(r.Z,{color:"teal",size:30})})})},66562:function(e,t,a){"use strict";a.r(t);var n=a(57437),r=a(2265),o=a(24748),l=a(92173),s=a(13621),i=a(56641),c=a(14948);t.default=()=>{let[e,t]=(0,r.useState)(null),[a,u]=(0,r.useState)([]),[d,p]=(0,r.useState)(""),[h,m]=(0,r.useState)(1),[g,f]=(0,r.useState)(null),[v,y]=(0,r.useState)([]),[j,x]=(0,r.useState)({name:"All Project",_id:""}),[_,b]=(0,r.useState)([]),[M,S]=(0,r.useState)(0),[P,w]=(0,r.useState)(0),[E,C]=(0,r.useState)(!1),[L,N]=(0,r.useState)(!0);(0,r.useEffect)(()=>{E&&C(!1)},[E]),(0,r.useEffect)(()=>{N(!1),N(!0),console.log("cooords",_)},[M]);let handleProjectChange=e=>{let t=A.find(t=>t.ProjectName===e);x({name:e,_id:t?t._id:""})};(0,r.useEffect)(()=>{let fetchData=async()=>{await getSitesAndProject()};fetchData()},[j]),(0,r.useEffect)(()=>{b(a.map(e=>({lat:e.latitude,lng:e.longitude,projectID:e.projectID,pumpName:e.pumpName})))},[a]),(0,r.useEffect)(()=>{calculateCentroid(),calculateZoomLevel()},[_,a]);let getSitesByProjectId=async()=>{try{let e={projectID:j._id},t=await l.Z.post("/api/sites/getSitesByProjectId",e);u(t.data.sites)}catch(e){console.error("Error fetching data:",e)}},getSitesAndProject=async()=>{try{m(e=>e+1),await Promise.all([getProjects(),getSitesByProjectId()])}catch(e){console.error("Error fetching data:",e)}},getProjects=async()=>{let e=await l.Z.get("/api/project/getAllProjects");y(e.data.projects)},{isLoaded:O}=(0,o.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyC_mmyHAnkTF9dUjcTngzxG9eHfS3oMbfM"}),handleMarkerHover=e=>{f(e)},handleMarkerLeave=()=>{f(null)},calculateCentroid=()=>{let e=0,t=0,a=_.length;for(let n=0;n<a;n++)e+=parseFloat(_[n].lat),t+=parseFloat(_[n].lng);let n={lat:e/a,lng:t/a};console.log("xxx old",n),S(n)},calculateZoomLevel=()=>{if(0===_.length)return 0;if(1===_.length)return 10;let e=Number.MAX_VALUE,t=Number.MIN_VALUE,a=Number.MAX_VALUE,n=Number.MIN_VALUE;for(let r=0;r<_.length;r++){let o=_[r];e=Math.min(e,parseFloat(o.lat)),t=Math.max(t,parseFloat(o.lat)),a=Math.min(a,parseFloat(o.lng)),n=Math.max(n,parseFloat(o.lng))}let r=t-e,o=n-a;w(Math.floor(Math.min(Math.log2(896/o),Math.log2(896/r))))},A=[{ProjectName:"All Project",_id:""},...v.filter(e=>e.ProjectName.toLowerCase().includes(d.toLowerCase()))];return(0,r.useEffect)(()=>{calculateCentroid(),calculateZoomLevel()},[_]),(0,n.jsxs)("div",{children:[O&&(0,n.jsx)(s.xu,{children:(0,n.jsxs)(o.b6,{mapContainerStyle:{width:"100%",height:"100vh"},center:M,zoom:P,onLoad:e=>{t(e)},onUnmount:()=>{t(null)},children:[(0,n.jsx)(s.xu,{position:"absolute",right:"14",top:"2",children:(0,n.jsx)(i.P,{variant:"filled",width:300,value:j.name,onChange:e=>handleProjectChange(e.target.value),children:A.map(e=>(0,n.jsx)("option",{value:e.ProjectName,children:e.ProjectName},e._id))})}),_.length>0&&_.map((e,t)=>(0,n.jsx)(o.Jx,{position:{lat:parseFloat(e.lat),lng:parseFloat(e.lng)},onMouseOver:()=>handleMarkerHover(t),onMouseOut:handleMarkerLeave,children:g===t&&(0,n.jsx)(o.nx,{position:{lat:parseFloat(e.lat),lng:parseFloat(e.lng)},onCloseClick:handleMarkerLeave,children:(0,n.jsx)("div",{children:e.pumpName})})},t))]})}),!O&&(0,n.jsx)(c.Z,{})]})}},53808:function(e,t,a){"use strict";a.d(t,{Z:function(){return esm_BeatLoader}});var n=a(2265),r={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function parseLengthAndUnit(e){if("number"==typeof e)return{value:e,unit:"px"};var t,a=(e.match(/^[0-9.]*/)||"").toString();t=a.includes(".")?parseFloat(a):parseInt(a,10);var n=(e.match(/[^0-9]*$/)||"").toString();return r[n]?{value:t,unit:n}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(t,"px.")),{value:t,unit:"px"})}function cssValue(e){var t=parseLengthAndUnit(e);return"".concat(t.value).concat(t.unit)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__rest=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]]);return a},o=function(e,t,a){var n="react-spinners-".concat(e,"-").concat(a);if("undefined"==typeof window||!window.document)return n;var r=document.createElement("style");document.head.appendChild(r);var o=r.sheet,l="\n    @keyframes ".concat(n," {\n      ").concat(t,"\n    }\n  ");return o&&o.insertRule(l,0),n}("BeatLoader","50% {transform: scale(0.75);opacity: 0.2} 100% {transform: scale(1);opacity: 1}","beat"),esm_BeatLoader=function(e){var t=e.loading,a=e.color,r=void 0===a?"#000000":a,l=e.speedMultiplier,s=void 0===l?1:l,i=e.cssOverride,c=e.size,u=void 0===c?15:c,d=e.margin,p=void 0===d?2:d,h=__rest(e,["loading","color","speedMultiplier","cssOverride","size","margin"]),m=__assign({display:"inherit"},void 0===i?{}:i),style=function(e){return{display:"inline-block",backgroundColor:r,width:cssValue(u),height:cssValue(u),margin:cssValue(p),borderRadius:"100%",animation:"".concat(o," ").concat(.7/s,"s ").concat(e%2?"0s":"".concat(.35/s,"s")," infinite linear"),animationFillMode:"both"}};return void 0===t||t?n.createElement("span",__assign({style:m},h),n.createElement("span",{style:style(1)}),n.createElement("span",{style:style(2)}),n.createElement("span",{style:style(3)})):null}}},function(e){e.O(0,[910,57,209,971,472,744],function(){return e(e.s=70842)}),_N_E=e.O()}]);